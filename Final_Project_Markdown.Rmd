---
title: "Final_Project"
author: "Christopher_Zdyrski"
date: "4/13/2021"
output: html_document
---
#This file is to make the RNASeq heatmap found in the Post et al. paper figure S.2F.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Install packages
```{r}
install.packages("tidyverse")
```

#Load in librarys
```{r}
library(readxl)
library(ggplot2)
library(tidyverse)
```

#Open data file
```{r}
#This is the data file we will use
raw_data <- read_excel("Copy of DMCs_Dryad.xlsx")
```

###Look at dimensions of the files
```{r}
#Analyze the raw_data file
head(raw_data)
dim(raw_data)
str(raw_data)
colnames(raw_data)
```

#Make Figure 2a
##You have to include state=identity when working with excel files
```{r}
dev.new() 

fig_two_a <- (ggplot(data=raw_data, aes(x=pvalue, y=meth.diff)) +
  geom_bar(stat='identity', position="fill") +
  labs(x = "Altitude", y = "Log10 DMC Count") +
  ggtitle("Figure 2a") +
  theme(plot.title = element_text(hjust = 0.5)))

print(fig_two_a)
pdf("Plots/fig_two_a.pdf")
```



#Make Figure 2b
```{r}
fig_two_b <- (ggplot(raw_data, aes(x = Chr_Position)) +
  geom_bar(stat='identity') +
  labs(x = "Altitude", y = "Î” Methylation") +
  theme(axis.text.x = element_text(angle = 90)) +
  ggtitle("Figure 2b") +
  theme(plot.title = element_text(hjust = 0.5)))

print(fig_2_a)
pdf("Plots/fig_two_b.pdf")
```

#Make Figure 6

#Have to sort out CG, CHG and CHH
```{r}
fig_six <- (ggplot(raw_data, aes(x = Chr_Position)) +
  geom_boxplot(position = "fill") +
  labs(x = "Loss/Gain Position", y = "DMC Density") +
  theme(axis.text.x = element_text(angle = 90)) +
  ggtitle("Figure 6, West to East") +
  theme(plot.title = element_text(hjust = 0.5)))

print(fig_six)
pdf("Plots/fig_6.pdf")
```